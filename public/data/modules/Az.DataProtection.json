{"module":"Az.DataProtection","version":"0.0.0","cmdlets":{"Backup-AzDataProtectionBackupInstanceAdhoc":{"syntax":"Backup-AzDataProtectionBackupInstanceAdhoc -BackupInstanceName <String> -ResourceGroupName <String>\n [-SubscriptionId <String>] -VaultName <String> -BackupRuleOptionRuleName <String>\n [-TriggerOptionRetentionTagOverride <String>] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$instance = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\"\nBackup-AzDataProtectionBackupInstanceAdhoc -BackupInstanceName $instance.Name -ResourceGroupName \"MyResourceGroup\" -SubscriptionId \"xxxx-xxx-xxxx\" -VaultName \"MyVault\" -BackupRuleOptionRuleName \"BackupWeekly\" -TriggerOptionRetentionTagOverride \"Default\"","$instance = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\"\n$policy = Get-AzDataProtectionBackupPolicy -SubscriptionId $sub -VaultName \"MyVault\" -ResourceGroupName \"MyResourceGroup\" | Where-Object {$_.Name -eq \"policyName\"}\n$backupJob = Backup-AzDataProtectionBackupInstanceAdhoc -BackupInstanceName $instance.Name -ResourceGroupName \"MyResourceGroup\" -SubscriptionId \"xxxx-xxx-xxxx\" -VaultName \"MyVault\" -BackupRuleOptionRuleName $policy.Property.PolicyRule[0].Name -TriggerOptionRetentionTagOverride $policy.Property.PolicyRule[0].Trigger.TaggingCriterion[0].TagInfoTagName\n$jobid = $backupJob.JobId.Split(\"/\")[-1]\n$jobstatus = \"InProgress\"\nwhile($jobstatus -ne \"Completed\")\n{\n    Start-Sleep -Seconds 10\n    $currentjob = Get-AzDataProtectionJob -Id $jobid -SubscriptionId $sub -ResourceGroupName $rgName -VaultName $vaultName\n    $jobstatus = $currentjob.Status\n}"]},"Edit-AzDataProtectionPolicyRetentionRuleClientObject":{"syntax":"Edit-AzDataProtectionPolicyRetentionRuleClientObject -Policy <IBackupPolicy> -Name <RetentionRuleName>\n [-RemoveRule] [<CommonParameters>]","examples":["$pol = Get-AzDataProtectionPolicyTemplate\n$lifecycle = New-AzDataProtectionRetentionLifeCycleClientObject -SourceDataStore OperationalStore -SourceRetentionDurationType Weeks -SourceRetentionDurationCount 5\nEdit-AzDataProtectionPolicyRetentionRuleClientObject -Policy $pol -Name Weekly -LifeCycles $lifecycle -IsDefault $false","The first command gets the default policy template.\nThe second command creates a weekly lifecycle object.\nThe third command adds a weekly retention rule to the default policy."]},"Edit-AzDataProtectionPolicyTagClientObject":{"syntax":"Edit-AzDataProtectionPolicyTagClientObject -Policy <IBackupPolicy> -Name <TagName> [-RemoveRule]\n [<CommonParameters>]","examples":["$criteria = New-AzDataProtectionPolicyTagCriteriaClientObject -AbsoluteCriteria FirstOfWeek\nEdit-AzDataProtectionPolicyTagClientObject -Policy $pol -Name Weekly -Criteria $criteria","This command adds a weekly tag to given backup policy"]},"Edit-AzDataProtectionPolicyTriggerClientObject":{"syntax":"Edit-AzDataProtectionPolicyTriggerClientObject -Policy <IBackupPolicy> [-RemoveSchedule]\n [<CommonParameters>]","examples":["$schedule = New-AzDataProtectionPolicyTriggerScheduleClientObject -ScheduleDays (Get-Date) -IntervalType Daily -IntervalCount 1\nEdit-AzDataProtectionPolicyTriggerClientObject -Policy $pol -Schedule $schedule"]},"Find-AzDataProtectionRestorableTimeRange":{"syntax":"Find-AzDataProtectionRestorableTimeRange -BackupInstanceName <String> -ResourceGroupName <String>\n -VaultName <String> [-SubscriptionId <String>] -SourceDataStoreType <RestoreSourceDataStoreType>\n [-EndTime <String>] [-StartTime <String>] [-DefaultProfile <PSObject>]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$startTime = (Get-Date).AddDays(-30).ToString(\"yyyy-MM-ddTHH:mm:ss.0000000Z\")\n$endTime = (Get-Date).AddDays(0).ToString(\"yyyy-MM-ddTHH:mm:ss.0000000Z\")\n$instances = Search-AzDataProtectionBackupInstanceInAzGraph -Subscription \"subscriptionId\" -DatasourceType AzureBlob -ResourceGroup \"rgName\" -Vault \"vaultName\"\n$pointInTimeRange = Find-AzDataProtectionRestorableTimeRange -BackupInstanceName $instances[0].BackupInstanceName -ResourceGroupName \"rgName\" -SubscriptionId \"subscriptionId\"  -VaultName \"vaultName\" -SourceDataStoreType OperationalStore -StartTime $startTime -EndTime $endTime\n$pointInTimeRange.RestorableTimeRange | Format-List"]},"Get-AzDataProtectionBackupInstance":{"syntax":"Get-AzDataProtectionBackupInstance -ResourceGroupName <String> [-SubscriptionId <String[]>] -VaultName <String>\n [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\"","This command gets all the backup instances in a vault."]},"Get-AzDataProtectionBackupInstancesExtensionRouting":{"syntax":"Get-AzDataProtectionBackupInstancesExtensionRouting -ResourceId <String> [-DefaultProfile <PSObject>]\n [<CommonParameters>]","examples":["$diskARMID = \"subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx/resourceGroups/testRG/providers/Microsoft.Compute/disks/testDisk\"\nGet-AzDataProtectionBackupInstancesExtensionRouting -ResourceId $diskARMID"]},"Get-AzDataProtectionBackupPolicy":{"syntax":"Get-AzDataProtectionBackupPolicy -ResourceGroupName <String> [-SubscriptionId <String[]>] -VaultName <String>\n [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["Get-AzDataProtectionBackupPolicy -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\"","This command gets backup policies created in a given backup vault."]},"Get-AzDataProtectionBackupVault":{"syntax":"Get-AzDataProtectionBackupVault [-SubscriptionId <String[]>] [-DefaultProfile <PSObject>]\n [<CommonParameters>]","examples":["Get-AzDataProtectionBackupVault","This command gets all backup vaults in current subscription context.\nProvide SubscriptionId parameter to retrieve backup vaults in a different subscription."]},"Get-AzDataProtectionJob":{"syntax":"Get-AzDataProtectionJob -ResourceGroupName <String> -VaultName <String> [-SubscriptionId <String[]>]\n [-UseSecondaryRegion] [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["Get-AzDataProtectionJob -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName sarath-rg -VaultName sarath-vault","This command gets all the backup jobs in a given backup vault."]},"Get-AzDataProtectionOperation":{"syntax":"Get-AzDataProtectionOperation [-DefaultProfile <PSObject>]\n [<CommonParameters>]","examples":["Get-AzDataProtectionOperation"]},"Get-AzDataProtectionOperationStatus":{"syntax":"Get-AzDataProtectionOperationStatus -Location <String> -OperationId <String> [-SubscriptionId <String[]>]\n [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["$operationResponse = Test-AzDataProtectionBackupInstanceReadiness -ResourceGroupName $resourceGroupName -VaultName $vaultName -SubscriptionId $subId -BackupInstance $backupInstanceClientObject.Property -NoWait\n$operationId = $operationResponse.Target.Split(\"/\")[-1].Split(\"?\")[0]\nGet-AzDataProtectionOperationStatus -OperationId $operationId -Location $vault.Location -SubscriptionId $subId\nWhile((Get-AzDataProtectionOperationStatus -OperationId $operationId -Location $vault.Location -SubscriptionId $subId).Status -eq \"Inprogress\"){\n\tStart-Sleep -Seconds 10\n}"]},"Get-AzDataProtectionPolicyTemplate":{"syntax":"Get-AzDataProtectionPolicyTemplate -DatasourceType <DatasourceTypes>\n [<CommonParameters>]","examples":["Get-AzDataProtectionPolicyTemplate -DatasourceType AzureDisk"]},"Get-AzDataProtectionRecoveryPoint":{"syntax":"Get-AzDataProtectionRecoveryPoint [-BackupInstanceName <String>] [-ResourceGroupName <String>]\n [-SubscriptionId <String[]>] [-VaultName <String>] [-DefaultProfile <PSObject>] [-StartTime <DateTime>]\n [-EndTime <DateTime>] [-UseSecondaryRegion] [<CommonParameters>]","examples":["$instance = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName sarath-rg -VaultName sarath-vault\nGet-AzDataProtectionRecoveryPoint -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName sarath-rg -VaultName sarath-vault -BackupInstanceName $instance[2].Name","This command lists all available recovery points of a given backup instance"]},"Get-AzDataProtectionResourceGuard":{"syntax":"Get-AzDataProtectionResourceGuard -ResourceGroupName <String> [-SubscriptionId <String[]>]\n [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["Get-AzDataProtectionResourceGuard -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"RGName\" -Name \"ResourceGuardName\"","Gets a resource guard under a resource group with name \"ResourceGuardName\""]},"Get-AzDataProtectionResourceGuardMapping":{"syntax":"Get-AzDataProtectionResourceGuardMapping -ResourceGroupName <String> [-SubscriptionId <String[]>]\n -VaultName <String> [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["$mapping = Get-AzDataProtectionResourceGuardMapping -ResourceGroupName $resourceGroupName -VaultName $vaultName -SubscriptionId $subscriptionId\n$mapping | fl"]},"Get-AzDataProtectionSoftDeletedBackupInstance":{"syntax":"Get-AzDataProtectionSoftDeletedBackupInstance -ResourceGroupName <String> [-SubscriptionId <String[]>]\n -VaultName <String> [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["Get-AzDataProtectionSoftDeletedBackupInstance -ResourceGroupName $resourceGroupName -SubscriptionId $subscriptionId -VaultName $vaultName"]},"Get-AzDataProtectionSoftDeletedBackupVault":{"syntax":"Get-AzDataProtectionSoftDeletedBackupVault -Location <String> [-SubscriptionId <String[]>]\n [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["Get-AzDataProtectionSoftDeletedBackupVault -Location \"eastasia\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\""]},"Initialize-AzDataProtectionBackupInstance":{"syntax":"Initialize-AzDataProtectionBackupInstance -DatasourceType <DatasourceTypes> -DatasourceLocation <String>\n [-PolicyId <String>] [-DatasourceId <String>] [-SecretStoreURI <String>] [-SecretStoreType <SecretStoreTypes>]\n [-SnapshotResourceGroupId <String>] [-FriendlyName <String>]\n [-BackupConfiguration <IBackupDatasourceParameters>] [-UseSystemAssignedIdentity <Boolean>]\n [-UserAssignedIdentityArmId <String>] [<CommonParameters>]","examples":["$policy = Get-AzDataProtectionBackupPolicy -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName sarath-rg -VaultName sarath-vault\n$AzureDiskId = \"/subscriptions/{subscription}/resourceGroups/{resourceGroup}/providers/Microsoft.Compute/disks/{diskname}\"\n$instance = Initialize-AzDataProtectionBackupInstance -DatasourceType AzureDisk -DatasourceLocation westus -DatasourceId $AzureDiskId -PolicyId $policy[0].Id\n$instance.Property.PolicyInfo.PolicyParameter.DataStoreParametersList[0].ResourceGroupId = \"/subscriptions/{subscription}/resourceGroups/{snapshotResourceGroup}\"\n$instance","The First command gets all the policies in a given vault.\nThe second command stores azure disk's resource id in $AzureDiskId\nvariable.\nThe third command returns a backup instance resource for Azure Disk.\nThe fourth command sets the snapshot resource group field.\nThis object can now be used to configure backup for the given disk."]},"Initialize-AzDataProtectionRestoreRequest":{"syntax":"Initialize-AzDataProtectionRestoreRequest -DatasourceType <DatasourceTypes> -SourceDataStore <DataStoreType>\n -RestoreLocation <String> -RestoreType <RestoreTargetType> -TargetResourceId <String>\n [-RecoveryPoint <String>] [-PointInTime <DateTime>] [-RehydrationDuration <String>]\n [-RehydrationPriority <String>] [-RestoreConfiguration <PSObject>] [-SecretStoreURI <String>]\n [-SecretStoreType <SecretStoreTypes>] [-UseSystemAssignedIdentity <Boolean>]\n [-UserAssignedIdentityArmId <String>] [<CommonParameters>]","examples":["$instance = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"sarath-rg\" -VaultName \"sarath-vault\"\n$rp = Get-AzDataProtectionRecoveryPoint -SubscriptionId \"xxx-xxx-xxx\" -ResourceGroupName \"sarath-rg\" -VaultName \"sarath-vault\" -BackupInstanceName $instance.Name\nInitialize-AzDataProtectionRestoreRequest -DatasourceType AzureDisk -SourceDataStore OperationalStore -RestoreLocation \"westus\"  -RestoreType AlternateLocation -TargetResourceId \"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroup}/providers/Microsoft.Compute/disks/{DiskName}\" -RecoveryPoint \"892e5c5014dc4a96807d22924f5745c9\"","This command initialized a restore request object which can be used to trigger restore."]},"New-AzDataProtectionBackupConfigurationClientObject":{"syntax":"New-AzDataProtectionBackupConfigurationClientObject -DatasourceType <DatasourceTypes>\n [-ExcludedResourceType <String[]>] [-IncludedResourceType <String[]>] [-ExcludedNamespace <String[]>]\n [-IncludedNamespace <String[]>] [-LabelSelector <String[]>] [-SnapshotVolume <Boolean>]\n [-IncludeClusterScopeResource <Boolean>] [-BackupHookReference <NamespacedNameResource[]>]\n [-VaultedBackupContainer <String[]>] [-IncludeAllContainer] [-StorageAccountName <String>]\n [-StorageAccountResourceGroupName <String>] [<CommonParameters>]","examples":["$backupConfig = New-AzDataProtectionBackupConfigurationClientObject -SnapshotVolume $true -IncludeClusterScopeResource $true -DatasourceType AzureKubernetesService -LabelSelector \"key=val\",\"foo=bar\" -ExcludedNamespace \"excludeNS1\",\"excludeNS2\" -BackupHookReference @(@{name='bkphookname';namespace='default'},@{name='bkphookname1';namespace='hrweb'})","This command can be used to create a backup configuration client object used for configuring backup for a Kubernetes cluster.\nBackupHookReferences is a list of references to BackupHooks that should be executed before and after the backup is executed."]},"New-AzDataProtectionBackupInstance":{"syntax":"New-AzDataProtectionBackupInstance -ResourceGroupName <String> -VaultName <String>\n -BackupInstance <IBackupInstanceResource> [-SubscriptionId <String>] [-Tag <Hashtable>]\n [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-WhatIf] [-Confirm]\n [<CommonParameters>]","examples":["$sub = \"xxxx-xxx-xx\"\n$DiskId = \"/subscriptions/{subscription}/resourceGroups/{resourcegroup}/providers/Microsoft.Compute/disks/{diskname}\"\n$policy = Get-AzDataProtectionBackupPolicy -SubscriptionId $sub -ResourceGroupName sarath-rg -VaultName sarath-vault -Name \"MyPolicy\"\n$instance = Initialize-AzDataProtectionBackupInstance -DatasourceType AzureDisk -DatasourceLocation $vault.Location -PolicyId $policy.Id -DatasourceId $DiskId \n$instance.Property.PolicyInfo.PolicyParameter.DataStoreParametersList[0].ResourceGroupId = \"/subscriptions/{subscription}/resourceGroups/{resourceGroup}\"\nNew-AzDataProtectionBackupInstance -SubscriptionId $sub -ResourceGroupName sarath-rg -VaultName sarath-vault -BackupInstance $instance","The third command gets the policy with which disk will be backed up.\nThe fourth command initializes the backup instance request.\nThe last command configures backup of the given azure disk in the backup vault."]},"New-AzDataProtectionBackupPolicy":{"syntax":"New-AzDataProtectionBackupPolicy -ResourceGroupName <String> -VaultName <String> -Name <String>\n -Policy <IBackupPolicy> [-SubscriptionId <String>] [-DefaultProfile <PSObject>]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$defaultPol = Get-AzDataProtectionPolicyTemplate -DatasourceType AzureDisk\nNew-AzDataProtectionBackupPolicy -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName sarath-rg -VaultName sarath-vault -Name \"MyPolicy\" -Policy $defaultPol","This command creates a default policy for Azure disk datasource type."]},"New-AzDataProtectionBackupVault":{"syntax":"New-AzDataProtectionBackupVault -ResourceGroupName <String> -VaultName <String> -Location <String>\n -StorageSetting <IStorageSetting[]> [-SubscriptionId <String>] [-ETag <String>] [-IdentityType <String>]\n [-AzureMonitorAlertsForAllJobFailure <AlertsState>] [-ImmutabilityState <ImmutabilityState>]\n [-CrossRegionRestoreState <CrossRegionRestoreState>]\n [-CrossSubscriptionRestoreState <CrossSubscriptionRestoreState>] [-SoftDeleteRetentionDurationInDay <Double>]\n [-SoftDeleteState <SoftDeleteState>] [-Tag <Hashtable>] [-IdentityUserAssignedIdentity <Hashtable>]\n [-CmkEncryptionState <EncryptionState>] [-CmkInfrastructureEncryption <InfrastructureEncryptionState>]\n [-CmkIdentityType <IdentityType>] [-CmkUserAssignedIdentityId <String>] [-CmkEncryptionKeyUri <String>]\n [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-WhatIf] [-Confirm]\n [<CommonParameters>]","examples":["$sub = \"xxxx-xxxx-xxxxx\"\n$storagesetting = New-AzDataProtectionBackupVaultStorageSettingObject -DataStoreType VaultStore -Type LocallyRedundant\nNew-AzDataProtectionBackupVault -SubscriptionId $sub -ResourceGroupName sarath-rg -VaultName \"MyVault\" -StorageSetting $storagesetting -Location westus","This command creates a new backup vault."]},"New-AzDataProtectionBackupVaultStorageSettingObject":{"syntax":"New-AzDataProtectionBackupVaultStorageSettingObject -Type <StorageSettingType> -DataStoreType <DataStoreType>\n [<CommonParameters>]","examples":["New-AzDataProtectionBackupVaultStorageSettingObject -Type GeoRedundant -DataStoreType VaultStore"]},"New-AzDataProtectionPolicyTagCriteriaClientObject":{"syntax":"New-AzDataProtectionPolicyTagCriteriaClientObject [-DaysOfWeek <DaysOfWeek[]>] [-WeeksOfMonth <WeeksOfMonth[]>]\n [-MonthsOfYear <MonthsOfYear[]>] [-ScheduleTimes <DateTime[]>]\n [<CommonParameters>]","examples":["New-AzDataProtectionPolicyTagCriteriaClientObject -AbsoluteCriteria FirstOfDay","This command creates a criteria object with absolute criteria."]},"New-AzDataProtectionPolicyTriggerScheduleClientObject":{"syntax":"New-AzDataProtectionPolicyTriggerScheduleClientObject -ScheduleDays <DateTime[]>\n -IntervalType <BackupFrequency> -IntervalCount <Int32>\n [<CommonParameters>]","examples":["$date = Get-Date\nNew-AzDataProtectionPolicyTriggerScheduleClientObject -ScheduleDays $date -IntervalType Daily -IntervalCount 1","This command creates a daily schedule for Azure Backup Rule"]},"New-AzDataProtectionResourceGuard":{"syntax":"New-AzDataProtectionResourceGuard -ResourceGroupName <String> -Name <String> -Location <String>\n [-SubscriptionId <String>] [-ETag <String>] [-IdentityType <String>] [-Tag <Hashtable>]\n [-DefaultProfile <PSObject>] [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["New-AzDataProtectionResourceGuard -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"mua-rg\" -Name \"mua-resource-guard\" -Location \"centraluseuap\""]},"New-AzDataProtectionRestoreConfigurationClientObject":{"syntax":"New-AzDataProtectionRestoreConfigurationClientObject -DatasourceType <DatasourceTypes>\n [-ExcludedResourceType <String[]>] [-IncludedResourceType <String[]>] [-ExcludedNamespace <String[]>]\n [-IncludedNamespace <String[]>] [-LabelSelector <String[]>] [-IncludeClusterScopeResource <Boolean>]\n [-ConflictPolicy <String>] [-NamespaceMapping <KubernetesClusterRestoreCriteriaNamespaceMappings>]\n [-PersistentVolumeRestoreMode <String>] [-RestoreHookReference <NamespacedNameResource[]>]\n [-ResourceModifierReference <NamespacedNameResource>] [-StagingResourceGroupId <String>]\n [-StagingStorageAccountId <String>] [<CommonParameters>]","examples":["$restoreConfig = New-AzDataProtectionRestoreConfigurationClientObject -DatasourceType AzureKubernetesService -PersistentVolumeRestoreMode RestoreWithVolumeData -IncludeClusterScopeResource $true -NamespaceMapping  @{\"sourcenamespace1\"=\"targetnamespace1\";\"sourcenamespace2\"=\"targetnamespace2\"} -ExcludedNamespace \"excludeNS1\",\"excludeNS2\" -RestoreHookReference @(@{name='restorehookname';namespace='default'},@{name='restorehookname1';namespace='hrweb'})"]},"New-AzDataProtectionRetentionLifeCycleClientObject":{"syntax":"New-AzDataProtectionRetentionLifeCycleClientObject -SourceDataStore <DataStoreType>\n -SourceRetentionDurationType <DurationType> -SourceRetentionDurationCount <Int32>\n [-TargetDataStore <DataStoreType>] [-CopyOption <CopyOption>]\n [<CommonParameters>]","examples":["New-AzDataProtectionRetentionLifeCycleClientObject -SourceDataStore OperationalStore -SourceRetentionDurationType Days -SourceRetentionDurationCount 30","This command creates a lifecycle object which stores the backup data in operational store for 30 days."]},"Remove-AzDataProtectionBackupInstance":{"syntax":"Remove-AzDataProtectionBackupInstance -Name <String> -ResourceGroupName <String> [-SubscriptionId <String>]\n -VaultName <String> [-Token <String>] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-PassThru]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$instance = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\"\nRemove-AzDataProtectionBackupInstance -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\" -Name $instance[0].name"]},"Remove-AzDataProtectionBackupPolicy":{"syntax":"Remove-AzDataProtectionBackupPolicy -Name <String> -ResourceGroupName <String> [-SubscriptionId <String>]\n -VaultName <String> [-DefaultProfile <PSObject>] [-PassThru] [-WhatIf]\n [-Confirm] [<CommonParameters>]","examples":["$policy = Get-AzDataProtectionBackupPolicy -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\"\nRemove-AzDataProtectionBackupPolicy -Name $policy[0].name -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\""]},"Remove-AzDataProtectionBackupVault":{"syntax":"Remove-AzDataProtectionBackupVault -ResourceGroupName <String> [-SubscriptionId <String>] -VaultName <String>\n [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-PassThru] [-WhatIf]\n [-Confirm] [<CommonParameters>]","examples":["Remove-AzDataProtectionBackupVault -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"MyResourceGroup\" -VaultName \"MyVault\""]},"Remove-AzDataProtectionResourceGuard":{"syntax":"Remove-AzDataProtectionResourceGuard -Name <String> -ResourceGroupName <String> [-SubscriptionId <String>]\n [-DefaultProfile <PSObject>] [-PassThru] [-WhatIf] [-Confirm]\n [<CommonParameters>]","examples":["Remove-AzDataProtectionResourceGuard -Name \"ResourceGuardName\" -ResourceGroupName \"ResourceGroupName\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\""]},"Remove-AzDataProtectionResourceGuardMapping":{"syntax":"Remove-AzDataProtectionResourceGuardMapping -ResourceGroupName <String> [-SubscriptionId <String>]\n -VaultName <String> [-DefaultProfile <PSObject>] [-PassThru] [-WhatIf]\n [-Confirm] [<CommonParameters>]","examples":["$token = (Get-AzAccessToken -AsSecureString -TenantId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\").Token\n$proxy = Get-AzDataProtectionResourceGuardMapping -ResourceGroupName $resourceGroupName -VaultName $vaultName -SubscriptionId $subscriptionId\n$unlock = Unlock-AzDataProtectionResourceGuardOperation -ResourceGroupName $resourceGroupName -SubscriptionId $subscriptionId -VaultName $vaultName -ResourceGuardOperationRequest DisableMUA -ResourceToBeDeleted $proxy.Id -SecureToken $token\nRemove-AzDataProtectionResourceGuardMapping -ResourceGroupName $resourceGroupName -SubscriptionId $subscriptionId -VaultName $vaultName"]},"Resume-AzDataProtectionBackupInstanceProtection":{"syntax":"Resume-AzDataProtectionBackupInstanceProtection -BackupInstanceName <String> -ResourceGroupName <String>\n [-SubscriptionId <String>] -VaultName <String> [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-PassThru]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["Resume-AzDataProtectionBackupInstanceProtection -BackupInstanceName $backupInstance.BackupInstanceName -ResourceGroupName \"rgName\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\" -VaultName \"vaultName\""]},"Search-AzDataProtectionBackupInstanceInAzGraph":{"syntax":"Search-AzDataProtectionBackupInstanceInAzGraph -Subscription <String[]> -DatasourceType <DatasourceTypes>\n [-ResourceGroup <String[]>] [-Vault <String[]>] [-ProtectionStatus <ProtectionStatus[]>]\n [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["Search-AzDataProtectionBackupInstanceInAzGraph -Subscription \"xxxx-xxx-xxx\" -DatasourceType AzureDisk","This command gets all protected azure disk backup instance in a given subscription"]},"Search-AzDataProtectionBackupVaultInAzGraph":{"syntax":"Search-AzDataProtectionBackupVaultInAzGraph -Subscription <String[]> [-ResourceGroup <String[]>]\n [-Vault <String[]>] [-DefaultProfile <PSObject>] [<CommonParameters>]","examples":["Search-AzDataProtectionBackupVaultInAzGraph -Subscription \"xxxxxxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroup $resourceGroupName -Vault $vaultName"]},"Search-AzDataProtectionJobInAzGraph":{"syntax":"Search-AzDataProtectionJobInAzGraph -Subscription <String[]> -DatasourceType <DatasourceTypes>\n [-ResourceGroup <String[]>] [-Vault <String[]>] [-StartTime <DateTime>] [-EndTime <DateTime>]\n [-Operation <JobOperation[]>] [-Status <JobStatus[]>] [-DefaultProfile <PSObject>]\n [<CommonParameters>]","examples":["$endtime = Get-Date\n$starttime = $endtime.AddHours(-5)\nSearch-AzDataProtectionJobInAzGraph -Subscription \"xxx-xxx-xxx\" -ResourceGroup sarath-rg -Vault sarath-vault -DatasourceType AzureDisk -StartTime $starttime -EndTime $endtime","This command gets all jobs in a vault in last 5 hours."]},"Search-AzDataProtectionSoftDeletedVaultBackupInstanceInAzGraph":{"syntax":"Search-AzDataProtectionSoftDeletedVaultBackupInstanceInAzGraph [-Subscription <String[]>]\n [-DeletedVaultName <String>] [-DeletedVaultId <String>] [-DefaultProfile <PSObject>]\n [<CommonParameters>]","examples":["$deletedVaults = Get-AzDataProtectionSoftDeletedBackupVault -Location \"westus\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"\n$vaultGuid = $deletedVaults[0].Name\n$deletedBI = Search-AzDataProtectionSoftDeletedVaultBackupInstanceInAzGraph -Subscription \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -DeletedVaultName $vaultGuid\n$deletedBI | Format-List","Retrieves deleted backup vaults, extracts the vault GUID (Name property), and searches for soft-deleted backup instances within that vault."]},"Set-AzDataProtectionMSIPermission":{"syntax":"Set-AzDataProtectionMSIPermission -VaultResourceGroup <String> -VaultName <String> -PermissionsScope <String>\n -BackupInstance <IBackupInstanceResource> [-KeyVaultId <String>] [-UserAssignedIdentityARMId <String>]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["Set-AzDataProtectionMSIPermission -BackupInstance $instance -VaultResourceGroup \"VaultRG\" -VaultName \"Vaultname\" -PermissionsScope \"ResourceGroup\"","The above command is used to assign permissions to the backup vault \"Vaultname\" under resource group \"VaultRG\" at the \"Resource Group\" scope of the disk."]},"Set-AzDataProtectionResourceGuardMapping":{"syntax":"Set-AzDataProtectionResourceGuardMapping -ResourceGroupName <String> -VaultName <String>\n [-SubscriptionId <String>] [-ResourceGuardId <String>] [-DefaultProfile <PSObject>]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$proxy = Set-AzDataProtectionResourceGuardMapping -ResourceGroupName $resourceGroupName -SubscriptionId $subscriptionId -VaultName $vaultName -ResourceGuardId $resourceGuardARMId\n$proxy | fl"]},"Start-AzDataProtectionBackupInstanceRestore":{"syntax":"Start-AzDataProtectionBackupInstanceRestore -ResourceGroupName <String> -BackupInstanceName <String>\n -VaultName <String> -Parameter <IAzureBackupRestoreRequest> [-SubscriptionId <String>]\n [-ResourceGuardOperationRequest <String[]>] [-Token <String>] [-SecureToken <SecureString>]\n [-RestoreToSecondaryRegion] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$instance = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxx-xxx-xxx\" -ResourceGroupName \"sarath-rg\" -VaultName \"sarath-vault\"\n$rp = Get-AzDataProtectionRecoveryPoint -SubscriptionId \"xxx-xxx-xxx\" -ResourceGroupName \"sarath-rg\" -VaultName \"sarath-vault\" -BackupInstanceName $instance.Name\n$restoreRequest = Initialize-AzDataProtectionRestoreRequest -DatasourceType AzureDisk -SourceDataStore OperationalStore -RestoreLocation \"westus\"  -RestoreType AlternateLocation -TargetResourceId \"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroup}/providers/Microsoft.Compute/disks/{DiskName}\" -RecoveryPoint $rp[0].name\nStart-AzDataProtectionBackupInstanceRestore -BackupInstanceName $instance.BackupInstanceName -ResourceGroupName sarath-rg -VaultName sarath-vault -SubscriptionId \"xxx-xxx-xxx\" -Parameter $restorerequest","$instance = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"resourceGroupName\" -VaultName \"vaultName\"\n$rp = Get-AzDataProtectionRecoveryPoint -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"resourceGroupName\" -VaultName \"vaultName\" -BackupInstanceName $instance.Name\n$targetResourceId = \"/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/resourceGroupName/providers/Microsoft.DBforPostgreSQL/servers/serverName/databases/targetDbName\"\n$secretURI = \"https://oss-keyvault.vault.azure.net/secrets/oss-secret\"\n$restoreRequest = Initialize-AzDataProtectionRestoreRequest -DatasourceType AzureDatabaseForPostgreSQL -SourceDataStore VaultStore -RestoreLocation \"westus\" -RestoreType AlternateLocation -TargetResourceId $targetResourceId -RecoveryPoint $rp[0].Property.RecoveryPointId -SecretStoreURI $secretURI -SecretStoreType AzureKeyVault\n$restoreJob = Start-AzDataProtectionBackupInstanceRestore -BackupInstanceName $instance.BackupInstanceName -ResourceGroupName resourceGroupName -VaultName vaultName -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -Parameter $restorerequest\n$jobid = $restoreJob.JobId.Split(\"/\")[-1]\n$jobstatus = \"InProgress\"\nwhile($jobstatus -ne \"Completed\")\n{\n    Start-Sleep -Seconds 10\n    $currentjob = Get-AzDataProtectionJob -Id $jobid -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"resourceGroupName\" -VaultName \"vaultName\"\n    $jobstatus = $currentjob.Status\n}","$instance = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"resourceGroupName\" -VaultName \"vaultName\"\n$rp = Get-AzDataProtectionRecoveryPoint -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"resourceGroupName\" -VaultName \"vaultName\" -BackupInstanceName $instance.Name\n$targetContainerURI = \"https://targetStorageAccount.blob.core.windows.net/targetContainerName\"\n$fileNamePrefix = \"restore_as_files_12345\"\n$restoreRequest = Initialize-AzDataProtectionRestoreRequest -DatasourceType AzureDatabaseForPostgreSQL -SourceDataStore VaultStore -RestoreLocation \"westus\" -RestoreType RestoreAsFiles -RecoveryPoint $rp[0].Property.RecoveryPointId -TargetContainerURI $targetContainerURI -FileNamePrefix $fileNamePrefix\n$restoreJob = Start-AzDataProtectionBackupInstanceRestore -BackupInstanceName $instance.BackupInstanceName -ResourceGroupName resourceGroupName -VaultName vaultName -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -Parameter $restorerequest\n$jobid = $restoreJob.JobId.Split(\"/\")[-1]\n$jobstatus = \"InProgress\"\nwhile($jobstatus -ne \"Completed\")\n{\n    Start-Sleep -Seconds 10\n    $currentjob = Get-AzDataProtectionJob -Id $jobid -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"resourceGroupName\" -VaultName \"vaultName\"\n    $jobstatus = $currentjob.Status\n}"]},"Stop-AzDataProtectionBackupInstanceProtection":{"syntax":"Stop-AzDataProtectionBackupInstanceProtection -ResourceGroupName <String> -BackupInstanceName <String>\n -VaultName <String> [-SubscriptionId <String>] [-ResourceGuardOperationRequest <String[]>] [-Token <String>]\n [-SecureToken <SecureString>] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-PassThru]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["Stop-AzDataProtectionBackupInstanceProtection -ResourceGroupName \"rgName\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\" -VaultName \"vaultName\" -BackupInstanceName $backupInstance.BackupInstanceName"]},"Suspend-AzDataProtectionBackupInstanceBackup":{"syntax":"Suspend-AzDataProtectionBackupInstanceBackup -ResourceGroupName <String> -BackupInstanceName <String>\n -VaultName <String> [-SubscriptionId <String>] [-ResourceGuardOperationRequest <String[]>] [-Token <String>]\n [-SecureToken <SecureString>] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-PassThru]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["Suspend-AzDataProtectionBackupInstanceBackup -ResourceGroupName \"rgName\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\" -VaultName \"vaultName\" -BackupInstanceName $backupInstance.BackupInstanceName"]},"Sync-AzDataProtectionBackupInstance":{"syntax":"Sync-AzDataProtectionBackupInstance -Name <String> -ResourceGroupName <String> -VaultName <String>\n [-SubscriptionId <String>] [-SyncType <SyncType>] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-PassThru]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["Sync-AzDataProtectionBackupInstance -ResourceGroupName \"rgName\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\" -VaultName \"vaultName\" -BackupInstanceName $backupInstance.BackupInstanceName"]},"Test-AzDataProtectionBackupInstanceReadiness":{"syntax":"Test-AzDataProtectionBackupInstanceReadiness -ResourceGroupName <String> -VaultName <String>\n [-SubscriptionId <String>] -BackupInstance <IBackupInstance> [-DefaultProfile <PSObject>] [-AsJob] [-NoWait]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$vault = Get-AzDataProtectionBackupVault -ResourceGroupName \"resourceGroupName\" -VaultName \"vaultName\"\n$diskBackupPolicy = Get-AzDataProtectionBackupPolicy -ResourceGroupName \"resourceGroupName\" -VaultName $vault.Name -Name \"diskBackupPolicy\"\n$diskId = \"/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourcegroups/rgName/providers/Microsoft.Compute/disks/test-disk\" \n$snapshotRG = \"/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/rgName\"\n$instance = Initialize-AzDataProtectionBackupInstance -SnapshotResourceGroupId $Snapshotrg -DatasourceType AzureDisk -DatasourceLocation $vault.Location -PolicyId $diskBackupPolicy[0].Id -DatasourceId $diskId \nTest-AzDataProtectionBackupInstanceReadiness -ResourceGroupName \"resourceGroupName\" -VaultName $vault.Name -BackupInstance  $instance[0].Property"]},"Test-AzDataProtectionBackupInstanceRestore":{"syntax":"Test-AzDataProtectionBackupInstanceRestore -ResourceGroupName <String> -Name <String> -VaultName <String>\n -RestoreRequest <IAzureBackupRestoreRequest> [-SubscriptionId <String>] [-RestoreToSecondaryRegion]\n [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-WhatIf] [-Confirm]\n [<CommonParameters>]","examples":["$instances  = Get-AzDataProtectionBackupInstance -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"testResourceGroup\" -VaultName \"testVault\" \n$pointInTimeRange = Find-AzDataProtectionRestorableTimeRange -BackupInstanceName $instances[0].BackupInstanceName -ResourceGroupName \"testResourceGroup\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -VaultName \"testVault\" -SourceDataStoreType OperationalStore -StartTime (Get-Date).AddDays(-30).ToString(\"yyyy-MM-ddTHH:mm:ss.0000000Z\") -EndTime (Get-Date).AddDays(0).ToString(\"yyyy-MM-ddTHH:mm:ss.0000000Z\")\n$vault = Get-AzDataProtectionBackupVault -ResourceGroupName \"testResourceGroup\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -VaultName \"testVault\"\n$RestoreRequestObject = Initialize-AzDataProtectionRestoreRequest -DatasourceType AzureBlob -SourceDataStore OperationalStore -RestoreLocation $vault.Location -RestoreType OriginalLocation -BackupInstance $instances[0] -PointInTime (Get-Date -Date $pointInTimeRange.RestorableTimeRange.EndTime)\n$validateRestore = Test-AzDataProtectionBackupInstanceRestore -Name $instances[0].Name -ResourceGroupName \"testResourceGroup\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -VaultName \"testVault\" -RestoreRequest $RestoreRequestObject","$validateRestore = Test-AzDataProtectionBackupInstanceRestore -ResourceGroupName $ResourceGroupName -Name $instance[0].Name -VaultName $VaultName -RestoreRequest $RestoreRequestObject -SubscriptionId $SubscriptionId -RestoreToSecondaryRegion"]},"Test-AzDataProtectionBackupInstanceUpdate":{"syntax":"Test-AzDataProtectionBackupInstanceUpdate -Name <String> -ResourceGroupName <String> -VaultName <String>\n [-SubscriptionId <String>] -BackupInstance <IBackupInstance> [-DefaultProfile <PSObject>] [-AsJob] [-NoWait]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$backupInstanceResource = Get-AzDataProtectionBackupInstance -ResourceGroupName $resourceGroupName -VaultName $vaultName -SubscriptionId $subscriptionId | Where-Object { $_.Name -match $backupInstanceName }\n$backupInstanceResource.Property.PolicyInfo.PolicyId = $newPolicyARMId\n\nTest-AzDataProtectionBackupInstanceUpdate -Name $backupInstanceResource.Name -ResourceGroupName $ResourceGroupName -VaultName $VaultName -SubscriptionId $SubscriptionId -BackupInstance $backupInstanceResource.Property"]},"Undo-AzDataProtectionBackupInstanceDeletion":{"syntax":"Undo-AzDataProtectionBackupInstanceDeletion -BackupInstanceName <String> -ResourceGroupName <String>\n [-SubscriptionId <String>] -VaultName <String> [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-PassThru]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$softDeletedBI = Get-AzDataProtectionSoftDeletedBackupInstance -ResourceGroupName $resourceGroupName -SubscriptionId $subscriptionId -VaultName $vaultName\nUndo-AzDataProtectionBackupInstanceDeletion -SubscriptionId $subscriptionId -ResourceGroupName $resourceGroupName -VaultName $vaultName -BackupInstanceName $softDeletedBI[0].Name"]},"Undo-AzDataProtectionVaultDeletion":{"syntax":"Undo-AzDataProtectionVaultDeletion -DeletedVaultName <String> -Location <String> [-SubscriptionId <String>]\n [-ResourceGroupName <String>] [-IdentityType <String>] [-IdentityUserAssignedIdentity <Hashtable>]\n [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-WhatIf] [-Confirm]\n [<CommonParameters>]","examples":["$deletedVaults = Get-AzDataProtectionSoftDeletedBackupVault -Location \"westus\" -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"\n$restoredVault = Undo-AzDataProtectionVaultDeletion -DeletedVaultName $deletedVaults[0].Name -Location $deletedVaults[0].Location -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName $deletedVaults[0].OriginalBackupVaultResourceGroup\n$restoredVault | Format-List","Retrieves deleted backup vaults from a location, selects the first vault, and undeletes it by undoing the deletion using the original vault properties."]},"Unlock-AzDataProtectionResourceGuardOperation":{"syntax":"Unlock-AzDataProtectionResourceGuardOperation -ResourceGroupName <String> -VaultName <String>\n [-SubscriptionId <String>] [-ResourceGuardOperationRequest <String[]>] [-ResourceToBeDeleted <String>]\n [-Token <String>] [-SecureToken <SecureString>] [-DefaultProfile <PSObject>]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$proxy = Get-AzDataProtectionResourceGuardMapping -ResourceGroupName $resourceGroupName -VaultName $vaultName -SubscriptionId $subscriptionId\n$operationRequests = $proxy.ResourceGuardOperationDetail.DefaultResourceRequest\n$resourceGuardOperationRequest = $operationRequests | Where-Object { $_ -match \"deleteBackupInstanceRequests\" }\n\n$token = (Get-AzAccessToken -AsSecureString -TenantId \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\").Token\n$instances = Get-AzDataProtectionBackupInstance -SubscriptionId $subscriptionId -ResourceGroupName $resourceGroupName -VaultName $vaultName\n\n$unlock = Unlock-AzDataProtectionResourceGuardOperation -ResourceGroupName $resourceGroupName -SubscriptionId $subscriptionId -VaultName $vault.Name -ResourceGuardOperationRequest $resourceGuardOperationRequest -ResourceToBeDeleted $instances[0].Id -SecureToken $token\n$unlock | fl \n\nRemove-AzDataProtectionBackupInstance -SubscriptionId $subscriptionId -ResourceGroupName $resourceGroupName -VaultName $vaultName  -Name $instances[0].Name","Ensure you have a contributor access over resource guard before doing unlock.\n\nFetch and pass the cross tenant authorization token in case the resource guard is present in a different tenant.\n\nThe first command fetches the resource guard mapping between backup vault and the resource guard.\nThe second command fetches the operation requests corresponding to all critical operations protected by resource guard.\nThe third command fetch the operation request corresponding to the operation we want to unlock.\nThe fourth command fetches the access token corresponding to resource guard tenant.\nThe fifth command fetches the backup instance we want to stop protection.\nThe sixth command unlocks the delete backup operation which is protected by the resource guard.\nEnsure to have contributor access over resource guard before unlock.\nFinally, we remove the backup instance for which we want to disable protection."]},"Update-AzDataProtectionBackupInstance":{"syntax":"Update-AzDataProtectionBackupInstance -ResourceGroupName <String> -VaultName <String>\n -BackupInstanceName <String> [-SubscriptionId <String>] [-PolicyId <String>]\n [-UseSystemAssignedIdentity <Boolean>] [-UserAssignedIdentityArmId <String>]\n [-VaultedBackupContainer <String[]>] [-ResourceGuardOperationRequest <String[]>] [-Token <String>]\n [-SecureToken <SecureString>] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$instance = Search-AzDataProtectionBackupInstanceInAzGraph -Subscription $subscriptionId -ResourceGroup $resourceGroupName -Vault $vaultName -DatasourceType AzureBlob\n$updatePolicy = Get-AzDataProtectionBackupPolicy -SubscriptionId $subscriptionId -VaultName $vaultName -ResourceGroupName $resourceGroupName| Where-Object { $_.name -eq \"vaulted-policy\" }\n$backedUpContainers = $instance.Property.PolicyInfo.PolicyParameter.BackupDatasourceParametersList[0].ContainersList\n$updateBI = Update-AzDataProtectionBackupInstance -ResourceGroupName $resourceGroupName -VaultName $vaultName -BackupInstanceName $instance.Name -SubscriptionId $subscriptionId -PolicyId $updatePolicy.Id -VaultedBackupContainer $backedUpContainers[0,2,4]\n$updateBI.Property.PolicyInfo.PolicyId\n$updateBI.Property.PolicyInfo.PolicyParameter.BackupDatasourceParametersList[0].ContainersList","First command fetch the backup instance which needs to be updated.\nSecond command gets the backup policy with name vaulted-policy which need to be updated in Backup Instance.\nThird command fetches the list of vaulted containers which are currently backed up in the backup vault.\nFourth command update the backup instance with new policy and new list of container (which is currently a subset of the existing backed up containers).\nFifth and sixth command shows the updated policy and containers list in the backup instance."]},"Update-AzDataProtectionBackupInstanceAssociatedPolicy":{"syntax":"Update-AzDataProtectionBackupInstanceAssociatedPolicy -ResourceGroupName <String> -VaultName <String>\n -BackupInstanceName <String> -PolicyId <String> [-SubscriptionId <String>]\n [-ResourceGuardOperationRequest <String[]>] [-Token <String>] [-SecureToken <SecureString>]\n [-DefaultProfile <PSObject>] [-AsJob] [-NoWait] [-WhatIf] [-Confirm]\n [<CommonParameters>]","examples":["$sub = \"xxxx-xxxx-xxxx\"\n$instance = Get-AzDataProtectionBackupInstance -SubscriptionId $sub -ResourceGroupName sarath-rg -VaultName sarath-vault\n$policy = Get-AzDataProtectionBackupPolicy -SubscriptionId $sub -ResourceGroupName sarath-rg -VaultName sarath-vault\nUpdate-AzDataProtectionBackupInstanceAssociatedPolicy -SubscriptionId $sub -ResourceGroupName sarath-rg -VaultName sarath-vault -BackupInstanceName $instance[0].Name -PolicyId $policy[1].Id"]},"Update-AzDataProtectionBackupVault":{"syntax":"Update-AzDataProtectionBackupVault [-Token <String>] [-AzureMonitorAlertsForAllJobFailure <AlertsState>]\n [-CrossRegionRestoreState <CrossRegionRestoreState>]\n [-CrossSubscriptionRestoreState <CrossSubscriptionRestoreState>] [-IdentityType <String>]\n [-IdentityUserAssignedIdentity <Hashtable>] [-ImmutabilityState <ImmutabilityState>]\n [-ResourceGuardOperationRequest <String[]>] [-SoftDeleteRetentionDurationInDay <Double>]\n [-SoftDeleteState <SoftDeleteState>] [-Tag <Hashtable>] [-DefaultProfile <PSObject>] [-AsJob] [-NoWait]\n -ResourceGroupName <String> -VaultName <String> [-SubscriptionId <String>]\n [-CmkEncryptionState <EncryptionState>] [-CmkIdentityType <IdentityType>]\n [-CmkUserAssignedIdentityId <String>] [-CmkEncryptionKeyUri <String>] [-SecureToken <SecureString>]\n [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$tag = @{\"Owner\"=\"sarath\";\"Purpose\"=\"AzureBackupTesting\"}\nUpdate-AzDataProtectionBackupVault -SubscriptionId \"xxx-xxx-xxx\" -ResourceGroupName sarath-rg -VaultName sarath-vault -Tag $tag","The first command creates a new tag hashtable with tags and their values.\nThe second command adds the given tags to the backup vault."]},"Update-AzDataProtectionResourceGuard":{"syntax":"Update-AzDataProtectionResourceGuard -ResourceGroupName <String> -Name <String> [-SubscriptionId <String>]\n [-ETag <String>] [-IdentityType <String>] [-Tag <Hashtable>] [-CriticalOperationExclusionList <String[]>]\n [-DefaultProfile <PSObject>] [-WhatIf] [-Confirm] [<CommonParameters>]","examples":["$resourceGuard = Get-AzDataProtectionResourceGuard -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"rgName\" -Name \"resGuardName\"\n$criticalOperations = $resourceGuard.ResourceGuardOperation.VaultCriticalOperation\n$operationsToBeExcluded = $criticalOperations | Where-Object { $_ -match \"backupSecurityPIN/action\" -or $_ -match \"backupInstances/delete\" }\nUpdate-AzDataProtectionResourceGuard -SubscriptionId \"xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx\" -ResourceGroupName \"rgName\" -Name $resourceGuard.Name -CriticalOperationExclusionList $operationsToBeExcluded"]}}}